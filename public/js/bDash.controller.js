'use strict';

angular.module('capstone').controller('bDashController', function ($scope, Bundles, $modal, Add, $rootScope) {

	(function () {
		var getAll = new Bundles.getAll();
		$scope.bundles = getAll.query();

		var getAllTags = new Bundles.getTags();
		$scope.existingTags = getAllTags.query();
	})();

	$scope['delete'] = function (id) {
		var deleteSelection = new Bundles.deleteOne();
		deleteSelection['delete']({ id: id }, function () {
			console.log('Deleted: ' + id);
			var getAll = new Bundles.getAll();
			$scope.bundles = getAll.query();
		});
	};
}).controller('addFormController', function (Bundles, $scope, Add) {
	$scope.activeTab = 'Story';

	$scope.bundleSubmit = function () {
		Add.addBundle({
			title: $scope.title,
			url: $scope.url,
			tags: $scope.tags
			// userId: $rootScope.currentUser._id *** ADD WHEN CURRENTUSER IS VALIDATED
		}).then(function () {
			$scope.title = null;
			$scope.url = null;
			$scope.tags = null;
			var getAll = new Bundles.getAll();
			$scope.bundles = getAll.query();
		});
	};

	$scope.storySubmit = function () {
		Add.addStory({
			title: $scope.storyTitle,
			description: $scope.storyDescription,
			tags: $scope.tags
			// userId: $rootScope.currentUser ADD USER ID WHEN LINK IS READY
		}).then(function () {
			$scope.addStoryForm = null;
			$scope.storyTitle = null;
			$scope.storyTags = null;
			$scope.storyDescription = null;
		});
	};
}).controller('detailsCtrl', function ($scope, Authorize, $state) {
	$scope.logout = function () {
		Authorize.logout().then(function () {
			$state.go('prelogin');
		});
	};
});
// CHANGE TO PUBLIC DASHBOARD
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9qcy9iRGFzaC5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FFekIsVUFBVSxDQUFDLGlCQUFpQixFQUFFLFVBQVUsTUFBTSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBRTs7QUFFbEYsRUFBQyxZQUFXO0FBQ1gsTUFBSSxNQUFNLEdBQUcsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUE7QUFDakMsUUFBTSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUE7O0FBRS9CLE1BQUksVUFBVSxHQUFHLElBQUksT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFBO0FBQ3RDLFFBQU0sQ0FBQyxZQUFZLEdBQUcsVUFBVSxDQUFDLEtBQUssRUFBRSxDQUFBO0VBQ3hDLENBQUEsRUFBRyxDQUFDOztBQUVMLE9BQU0sVUFBTyxHQUFHLFVBQVUsRUFBRSxFQUFFO0FBQzdCLE1BQUksZUFBZSxHQUFHLElBQUksT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFBO0FBQzdDLGlCQUFlLFVBQU8sQ0FBQyxFQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUMsRUFBRSxZQUFVO0FBQzFDLFVBQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQyxDQUFBO0FBQzdCLE9BQUksTUFBTSxHQUFHLElBQUksT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFBO0FBQ2pDLFNBQU0sQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFBO0dBQy9CLENBQUMsQ0FBQTtFQUNGLENBQUE7Q0FFRCxDQUFDLENBRUQsVUFBVSxDQUFDLG1CQUFtQixFQUFFLFVBQVUsT0FBTyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUU7QUFDaEUsT0FBTSxDQUFDLFNBQVMsR0FBRyxPQUFPLENBQUE7O0FBRTFCLE9BQU0sQ0FBQyxZQUFZLEdBQUcsWUFBVztBQUNoQyxLQUFHLENBQUMsU0FBUyxDQUFDO0FBQ1osUUFBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLO0FBQ25CLE1BQUcsRUFBRSxNQUFNLENBQUMsR0FBRztBQUNmLE9BQUksRUFBRSxNQUFNLENBQUMsSUFBSTs7QUFBQSxHQUVqQixDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVc7QUFDbEIsU0FBTSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7QUFDcEIsU0FBTSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUM7QUFDbEIsU0FBTSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7QUFDbkIsT0FBSSxNQUFNLEdBQUcsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUE7QUFDakMsU0FBTSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUE7R0FDL0IsQ0FBQyxDQUFBO0VBQ0gsQ0FBQTs7QUFFRCxPQUFNLENBQUMsV0FBVyxHQUFHLFlBQVk7QUFDaEMsS0FBRyxDQUFDLFFBQVEsQ0FBQztBQUNaLFFBQUssRUFBRSxNQUFNLENBQUMsVUFBVTtBQUN4QixjQUFXLEVBQUUsTUFBTSxDQUFDLGdCQUFnQjtBQUNwQyxPQUFJLEVBQUUsTUFBTSxDQUFDLElBQUk7O0FBQUEsR0FFakIsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFXO0FBQ2pCLFNBQU0sQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFBO0FBQzFCLFNBQU0sQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFBO0FBQ3hCLFNBQU0sQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFBO0FBQ3ZCLFNBQU0sQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUE7R0FDOUIsQ0FBQyxDQUFBO0VBQ0gsQ0FBQTtDQUVELENBQUMsQ0FFRCxVQUFVLENBQUMsYUFBYSxFQUFFLFVBQVUsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUU7QUFDL0QsT0FBTSxDQUFDLE1BQU0sR0FBRyxZQUFXO0FBQzFCLFdBQVMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxJQUFJLENBQUMsWUFBVztBQUNsQyxTQUFNLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFBO0dBQ3JCLENBQUMsQ0FBQTtFQUNGLENBQUE7Q0FFRCxDQUFDLENBQUEiLCJmaWxlIjoic3JjL2pzL2JEYXNoLmNvbnRyb2xsZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnY2Fwc3RvbmUnKVxuXG4uY29udHJvbGxlcignYkRhc2hDb250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgQnVuZGxlcywgJG1vZGFsLCBBZGQsICRyb290U2NvcGUpIHtcblxuXHQoZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGdldEFsbCA9IG5ldyBCdW5kbGVzLmdldEFsbCgpXG5cdFx0JHNjb3BlLmJ1bmRsZXMgPSBnZXRBbGwucXVlcnkoKVxuXG5cdFx0dmFyIGdldEFsbFRhZ3MgPSBuZXcgQnVuZGxlcy5nZXRUYWdzKClcblx0XHQkc2NvcGUuZXhpc3RpbmdUYWdzID0gZ2V0QWxsVGFncy5xdWVyeSgpXG5cdH0pKCk7XG5cblx0JHNjb3BlLmRlbGV0ZSA9IGZ1bmN0aW9uIChpZCkge1xuXHRcdHZhciBkZWxldGVTZWxlY3Rpb24gPSBuZXcgQnVuZGxlcy5kZWxldGVPbmUoKVxuXHRcdGRlbGV0ZVNlbGVjdGlvbi5kZWxldGUoe2lkOiBpZH0sIGZ1bmN0aW9uKCl7XG5cdFx0XHRjb25zb2xlLmxvZygnRGVsZXRlZDogJyArIGlkKVxuXHRcdFx0dmFyIGdldEFsbCA9IG5ldyBCdW5kbGVzLmdldEFsbCgpXG5cdFx0XHQkc2NvcGUuYnVuZGxlcyA9IGdldEFsbC5xdWVyeSgpXG5cdFx0fSlcblx0fVxuXG59KVxuXG4uY29udHJvbGxlcignYWRkRm9ybUNvbnRyb2xsZXInLCBmdW5jdGlvbiAoQnVuZGxlcywgJHNjb3BlLCBBZGQpIHtcblx0JHNjb3BlLmFjdGl2ZVRhYiA9ICdTdG9yeSdcblxuXHQkc2NvcGUuYnVuZGxlU3VibWl0ID0gZnVuY3Rpb24oKSB7XG5cdFx0QWRkLmFkZEJ1bmRsZSh7XG5cdFx0XHRcdHRpdGxlOiAkc2NvcGUudGl0bGUsXG5cdFx0XHRcdHVybDogJHNjb3BlLnVybCxcblx0XHRcdFx0dGFnczogJHNjb3BlLnRhZ3Ncblx0XHRcdFx0Ly8gdXNlcklkOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLl9pZCAqKiogQUREIFdIRU4gQ1VSUkVOVFVTRVIgSVMgVkFMSURBVEVEXG5cdFx0XHR9KS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkc2NvcGUudGl0bGUgPSBudWxsO1xuXHRcdFx0XHQkc2NvcGUudXJsID0gbnVsbDtcblx0XHRcdFx0JHNjb3BlLnRhZ3MgPSBudWxsO1xuXHRcdFx0XHR2YXIgZ2V0QWxsID0gbmV3IEJ1bmRsZXMuZ2V0QWxsKClcblx0XHRcdFx0JHNjb3BlLmJ1bmRsZXMgPSBnZXRBbGwucXVlcnkoKVxuXHRcdFx0fSlcblx0fVxuXG5cdCRzY29wZS5zdG9yeVN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRBZGQuYWRkU3Rvcnkoe1xuXHRcdFx0dGl0bGU6ICRzY29wZS5zdG9yeVRpdGxlLFxuXHRcdFx0ZGVzY3JpcHRpb246ICRzY29wZS5zdG9yeURlc2NyaXB0aW9uLFxuXHRcdFx0dGFnczogJHNjb3BlLnRhZ3Ncblx0XHRcdC8vIHVzZXJJZDogJHJvb3RTY29wZS5jdXJyZW50VXNlciBBREQgVVNFUiBJRCBXSEVOIExJTksgSVMgUkVBRFlcblx0XHR9KS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkc2NvcGUuYWRkU3RvcnlGb3JtID0gbnVsbFxuXHRcdFx0XHQkc2NvcGUuc3RvcnlUaXRsZSA9IG51bGxcblx0XHRcdFx0JHNjb3BlLnN0b3J5VGFncyA9IG51bGxcblx0XHRcdFx0JHNjb3BlLnN0b3J5RGVzY3JpcHRpb24gPSBudWxsXG5cdFx0XHR9KVxuXHR9XG5cbn0pXG5cbi5jb250cm9sbGVyKCdkZXRhaWxzQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIEF1dGhvcml6ZSwgJHN0YXRlKSB7XG5cdCRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcblx0XHRBdXRob3JpemUubG9nb3V0KCkudGhlbihmdW5jdGlvbigpIHtcblx0XHRcdCRzdGF0ZS5nbygncHJlbG9naW4nKSAvLyBDSEFOR0UgVE8gUFVCTElDIERBU0hCT0FSRFxuXHRcdH0pXG5cdH1cblxufSlcblxuXG5cbiJdfQ==
