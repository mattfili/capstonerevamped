'use strict';

angular.module('capstone').controller('bDashController', function ($scope, Bundles, $modal, Add, $rootScope) {

	(function () {
		var getAll = new Bundles.getAll();
		$scope.bundles = getAll.query();

		var getAllTags = new Bundles.getTags();
		$scope.existingTags = getAllTags.query();
	})();

	$scope['delete'] = function (id) {
		var deleteSelection = new Bundles.deleteOne();
		deleteSelection['delete']({ id: id }, function () {
			console.log('Deleted: ' + id);
			var getAll = new Bundles.getAll();
			$scope.bundles = getAll.query();
		});
	};
}).controller('addFormController', function (Bundles, $scope) {
	$scope.activeTab = 'Story';

	$scope.bundleSubmit = function () {
		Add.addBundle({
			title: $scope.title,
			url: $scope.url,
			tags: $scope.tags
			// userId: $rootScope.currentUser._id *** ADD WHEN CURRENTUSER IS VALIDATED
		}).then(function () {
			$scope.title = null;
			$scope.url = null;
			$scope.tags = null;
			var getAll = new Bundles.getAll();
			$scope.bundles = getAll.query();
		});
	};

	$scope.storySubmit = function () {
		Add.addStory({
			title: $scope.storyTitle,
			description: $scope.storyDescription,
			tags: $scope.tags
			// userId: $rootScope.currentUser ADD USER ID WHEN LINK IS READY
		}).then(function () {
			$scope.addStoryForm = null;
			$scope.storyTitle = null;
			$scope.storyTags = null;
			$scope.storyDescription = null;
		});
	};

	$scope.filter = function (tags) {
		console.log(tags);
	};
}).controller('detailsCtrl', function ($scope, Authorize, $state) {
	$scope.logout = function () {
		Authorize.logout().then(function () {
			$state.go('prelogin'); // CHANGE TO PUBLIC DASHBOARD
		});
	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9qcy9iRGFzaC5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FFekIsVUFBVSxDQUFDLGlCQUFpQixFQUFFLFVBQVUsTUFBTSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBRTs7QUFFbEYsRUFBQyxZQUFXO0FBQ1gsTUFBSSxNQUFNLEdBQUcsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUE7QUFDakMsUUFBTSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUE7O0FBRS9CLE1BQUksVUFBVSxHQUFHLElBQUksT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFBO0FBQ3RDLFFBQU0sQ0FBQyxZQUFZLEdBQUcsVUFBVSxDQUFDLEtBQUssRUFBRSxDQUFBO0VBQ3hDLENBQUEsRUFBRyxDQUFDOztBQUVMLE9BQU0sVUFBTyxHQUFHLFVBQVUsRUFBRSxFQUFFO0FBQzdCLE1BQUksZUFBZSxHQUFHLElBQUksT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFBO0FBQzdDLGlCQUFlLFVBQU8sQ0FBQyxFQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUMsRUFBRSxZQUFVO0FBQzFDLFVBQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQyxDQUFBO0FBQzdCLE9BQUksTUFBTSxHQUFHLElBQUksT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFBO0FBQ2pDLFNBQU0sQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFBO0dBQy9CLENBQUMsQ0FBQTtFQUNGLENBQUE7Q0FHRCxDQUFDLENBRUQsVUFBVSxDQUFDLG1CQUFtQixFQUFFLFVBQVUsT0FBTyxFQUFFLE1BQU0sRUFBRTtBQUMzRCxPQUFNLENBQUMsU0FBUyxHQUFHLE9BQU8sQ0FBQTs7QUFFMUIsT0FBTSxDQUFDLFlBQVksR0FBRyxZQUFXO0FBQ2hDLEtBQUcsQ0FBQyxTQUFTLENBQUM7QUFDWixRQUFLLEVBQUUsTUFBTSxDQUFDLEtBQUs7QUFDbkIsTUFBRyxFQUFFLE1BQU0sQ0FBQyxHQUFHO0FBQ2YsT0FBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJOztHQUVqQixDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVc7QUFDbEIsU0FBTSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7QUFDcEIsU0FBTSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUM7QUFDbEIsU0FBTSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7QUFDbkIsT0FBSSxNQUFNLEdBQUcsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUE7QUFDakMsU0FBTSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUE7R0FDL0IsQ0FBQyxDQUFBO0VBQ0gsQ0FBQTs7QUFFRCxPQUFNLENBQUMsV0FBVyxHQUFHLFlBQVk7QUFDaEMsS0FBRyxDQUFDLFFBQVEsQ0FBQztBQUNaLFFBQUssRUFBRSxNQUFNLENBQUMsVUFBVTtBQUN4QixjQUFXLEVBQUUsTUFBTSxDQUFDLGdCQUFnQjtBQUNwQyxPQUFJLEVBQUUsTUFBTSxDQUFDLElBQUk7O0dBRWpCLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBVztBQUNqQixTQUFNLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQTtBQUMxQixTQUFNLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQTtBQUN4QixTQUFNLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQTtBQUN2QixTQUFNLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFBO0dBQzlCLENBQUMsQ0FBQTtFQUNILENBQUE7O0FBRUQsT0FBTSxDQUFDLE1BQU0sR0FBRyxVQUFVLElBQUksRUFBRTtBQUMvQixTQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0VBQ2xCLENBQUE7Q0FFRCxDQUFDLENBRUQsVUFBVSxDQUFDLGFBQWEsRUFBRSxVQUFVLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFO0FBQy9ELE9BQU0sQ0FBQyxNQUFNLEdBQUcsWUFBVztBQUMxQixXQUFTLENBQUMsTUFBTSxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVc7QUFDbEMsU0FBTSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQTtHQUNyQixDQUFDLENBQUE7RUFDRixDQUFBO0NBRUQsQ0FBQyxDQUFBIiwiZmlsZSI6ImJEYXNoLmNvbnRyb2xsZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnY2Fwc3RvbmUnKVxuXG4uY29udHJvbGxlcignYkRhc2hDb250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgQnVuZGxlcywgJG1vZGFsLCBBZGQsICRyb290U2NvcGUpIHtcblxuXHQoZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGdldEFsbCA9IG5ldyBCdW5kbGVzLmdldEFsbCgpXG5cdFx0JHNjb3BlLmJ1bmRsZXMgPSBnZXRBbGwucXVlcnkoKVxuXG5cdFx0dmFyIGdldEFsbFRhZ3MgPSBuZXcgQnVuZGxlcy5nZXRUYWdzKClcblx0XHQkc2NvcGUuZXhpc3RpbmdUYWdzID0gZ2V0QWxsVGFncy5xdWVyeSgpXG5cdH0pKCk7XG5cblx0JHNjb3BlLmRlbGV0ZSA9IGZ1bmN0aW9uIChpZCkge1xuXHRcdHZhciBkZWxldGVTZWxlY3Rpb24gPSBuZXcgQnVuZGxlcy5kZWxldGVPbmUoKVxuXHRcdGRlbGV0ZVNlbGVjdGlvbi5kZWxldGUoe2lkOiBpZH0sIGZ1bmN0aW9uKCl7XG5cdFx0XHRjb25zb2xlLmxvZygnRGVsZXRlZDogJyArIGlkKVxuXHRcdFx0dmFyIGdldEFsbCA9IG5ldyBCdW5kbGVzLmdldEFsbCgpXG5cdFx0XHQkc2NvcGUuYnVuZGxlcyA9IGdldEFsbC5xdWVyeSgpXG5cdFx0fSlcblx0fVxuXG5cbn0pXG5cbi5jb250cm9sbGVyKCdhZGRGb3JtQ29udHJvbGxlcicsIGZ1bmN0aW9uIChCdW5kbGVzLCAkc2NvcGUpIHtcblx0JHNjb3BlLmFjdGl2ZVRhYiA9ICdTdG9yeSdcblxuXHQkc2NvcGUuYnVuZGxlU3VibWl0ID0gZnVuY3Rpb24oKSB7XG5cdFx0QWRkLmFkZEJ1bmRsZSh7XG5cdFx0XHRcdHRpdGxlOiAkc2NvcGUudGl0bGUsXG5cdFx0XHRcdHVybDogJHNjb3BlLnVybCxcblx0XHRcdFx0dGFnczogJHNjb3BlLnRhZ3Ncblx0XHRcdFx0Ly8gdXNlcklkOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLl9pZCAqKiogQUREIFdIRU4gQ1VSUkVOVFVTRVIgSVMgVkFMSURBVEVEXG5cdFx0XHR9KS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkc2NvcGUudGl0bGUgPSBudWxsO1xuXHRcdFx0XHQkc2NvcGUudXJsID0gbnVsbDtcblx0XHRcdFx0JHNjb3BlLnRhZ3MgPSBudWxsO1xuXHRcdFx0XHR2YXIgZ2V0QWxsID0gbmV3IEJ1bmRsZXMuZ2V0QWxsKClcblx0XHRcdFx0JHNjb3BlLmJ1bmRsZXMgPSBnZXRBbGwucXVlcnkoKVxuXHRcdFx0fSlcblx0fVxuXG5cdCRzY29wZS5zdG9yeVN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRBZGQuYWRkU3Rvcnkoe1xuXHRcdFx0dGl0bGU6ICRzY29wZS5zdG9yeVRpdGxlLFxuXHRcdFx0ZGVzY3JpcHRpb246ICRzY29wZS5zdG9yeURlc2NyaXB0aW9uLFxuXHRcdFx0dGFnczogJHNjb3BlLnRhZ3Ncblx0XHRcdC8vIHVzZXJJZDogJHJvb3RTY29wZS5jdXJyZW50VXNlciBBREQgVVNFUiBJRCBXSEVOIExJTksgSVMgUkVBRFlcblx0XHR9KS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkc2NvcGUuYWRkU3RvcnlGb3JtID0gbnVsbFxuXHRcdFx0XHQkc2NvcGUuc3RvcnlUaXRsZSA9IG51bGxcblx0XHRcdFx0JHNjb3BlLnN0b3J5VGFncyA9IG51bGxcblx0XHRcdFx0JHNjb3BlLnN0b3J5RGVzY3JpcHRpb24gPSBudWxsXG5cdFx0XHR9KVxuXHR9XG5cblx0JHNjb3BlLmZpbHRlciA9IGZ1bmN0aW9uICh0YWdzKSB7XG5cdFx0Y29uc29sZS5sb2codGFncyk7XG5cdH1cblxufSlcblxuLmNvbnRyb2xsZXIoJ2RldGFpbHNDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgQXV0aG9yaXplLCAkc3RhdGUpIHtcblx0JHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xuXHRcdEF1dGhvcml6ZS5sb2dvdXQoKS50aGVuKGZ1bmN0aW9uKCkge1xuXHRcdFx0JHN0YXRlLmdvKCdwcmVsb2dpbicpIC8vIENIQU5HRSBUTyBQVUJMSUMgREFTSEJPQVJEXG5cdFx0fSlcblx0fVxuXG59KVxuXG5cblxuIl19
